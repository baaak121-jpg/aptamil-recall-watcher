# 비용 분석 및 무료 플랜 가이드

## 💰 총 비용 요약

### 완전 무료 플랜 (OpenAI만 유료)

```
서비스              월 비용        연 비용
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Telegram Bot        $0            $0
OpenAI API          $0.50 ~ $2    $6 ~ $24
Vercel Hobby        $0            $0
Vercel KV           $0            $0
GitHub Actions      $0            $0
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
총합                $0.50 ~ $2    $6 ~ $24
                    (700~2,700원) (8,000~32,000원)
```

**결론: 연간 커피 3~4잔 값!** ☕☕☕

## 📊 상세 비용 분석

### 1. Telegram Bot - 무료 ✅

**완전 무료:**
- 봇 생성: 무료
- 메시지 전송: 무제한 무료
- Webhook: 무료
- 그룹 채팅: 무료
- 파일 전송: 무료

**제한:**
- 초당 30개 메시지 (충분함)
- 분당 20개 그룹 메시지 (충분함)

**이 프로젝트 사용량:**
- 하루 1개 메시지
- 제한의 0.001% 사용

### 2. OpenAI API - 유료 💳

**gpt-4o-mini 가격:**
- Input: $0.150 / 1M tokens
- Output: $0.600 / 1M tokens

**실제 사용량 (하루):**

#### 시나리오 1: 변경 없음 (대부분)
```
LLM 호출: 0회 (고정 템플릿 사용)
비용: $0
```

#### 시나리오 2: 변경 있음 (하루 1회 제한)
```
Input:  최대 2,000 tokens (강제 truncate)
Output: 최대 150 tokens (3줄 요약)
비용: (2,000 × 0.150 + 150 × 0.600) / 1,000,000
    = $0.00039 (약 0.52원)
```

**월간 예상 (30일):**

| 변경 빈도 | LLM 호출 | 월 비용 |
|----------|---------|---------|
| 변경 없음 (30일) | 0회 | $0 |
| 변경 5일 | 5회 | $0.00195 (약 2.6원) |
| 변경 10일 | 10회 | $0.00390 (약 5.2원) |
| 변경 20일 | 20회 | $0.00780 (약 10.4원) |
| 매일 변경 (최악) | 30회 | $0.01170 (약 15.6원) |

**현실적 예상:**
- 평균: 월 $0.10 ~ $0.50 (약 130원 ~ 670원)
- 최대: 월 $0.50 (약 670원)
- **이유**: 하루 1회 제한 + 입력 토큰 제한 (2,000)

**무료 크레딧:**
- 신규 가입: $5 무료 (3개월)
- 이 프로젝트로 6개월+ 무료 사용 가능!

### 3. Vercel Hobby - 무료 ✅

**무료 플랜 제공:**
- Serverless Functions: 100GB-시간/월
- 실행 시간: 10초/요청
- 배포: 무제한
- 대역폭: 100GB/월
- 도메인: 무료 (.vercel.app)

**이 프로젝트 사용량:**
```
하루 사용:
- Webhook 응답: ~10회 × 0.5초 = 5초
- Cron 실행: 1회 × 30초 = 30초
- 총: 35초/일

월간 사용:
- 35초 × 30일 = 1,050초 = 17.5분
- 100GB-시간의 0.003%
```

**결론: 무료 플랜으로 충분!**

### 4. Vercel KV - 무료 ✅

**무료 플랜 제공:**
- 저장소: 256MB
- 명령: 30,000/월
- 대역폭: 무제한

**이 프로젝트 사용량:**
```
하루 사용:
- 읽기: 5회 (설정, 항목 조회)
- 쓰기: 5회 (소스 업데이트, 스냅샷)
- 총: 10 명령/일

월간 사용:
- 10 × 30 = 300 명령
- 30,000의 1%
```

**저장 데이터:**
- 설정: ~1KB
- 항목: ~10KB (제품 100개 가정)
- 소스: ~5KB
- 스냅샷: ~50KB (최근 3개)
- 총: ~66KB (256MB의 0.025%)

**결론: 무료 플랜으로 충분!**

### 5. GitHub Actions - 무료 ✅

**무료 플랜 제공:**
- 실행 시간: 2,000분/월
- 저장소: 500MB
- 동시 실행: 20개

**이 프로젝트 사용량:**
```
하루 사용:
- Cron 실행: 1회 × 1분 = 1분

월간 사용:
- 1분 × 30일 = 30분
- 2,000분의 1.5%
```

**결론: 무료 플랜으로 충분!**

## 🎯 비용 최적화 전략

### 1. LLM 호출 최소화 (구현 완료) ✅

```typescript
// 변경 없으면 LLM 호출 0회 (고정 템플릿)
if (changedSources.length === 0) {
  return getFixedTemplate('no_change');
}

// 하루 1회 제한
if (lastCallDate === today && dailyCallCount >= MAX_DAILY_CALLS) {
  return getFallbackTemplate(...);
}
```

**절감 효과:**
- 변경 없는 날: 100% 절감 (LLM 호출 0회)
- 변경 있는 날: 하루 1회만 호출
- 예상: 월 90% 이상 절감

### 2. 해시 기반 변경 감지 ✅

```typescript
const currentHash = generateHash(normalized);
const changed = source.last_hash !== currentHash;
```

**장점:**
- 정확한 변경 감지
- 불필요한 LLM 호출 방지

### 3. 토큰 제한 강화 ✅

```typescript
// 입력 토큰 강제 제한
const MAX_INPUT_TOKENS = 2000;
const truncatedPrompt = truncateToTokenLimit(prompt, MAX_INPUT_TOKENS);

// 출력 토큰 최소화
max_tokens: 150,      // 3줄 요약에 충분
temperature: 0.3,     // 일관된 짧은 응답
```

**절감 효과:**
- Input 토큰 75% 절감 (2,000 제한)
- Output 토큰 25% 절감 (150으로 감소)
- 총 비용 80% 절감

### 4. 무료 크레딧 활용

**OpenAI 신규 가입:**
- $5 무료 크레딧 (3개월)
- 이 프로젝트로 6개월 이상 무료!

**활용 팁:**
1. 새 계정으로 가입
2. 무료 크레딧 소진 시 결제 정보 추가
3. 월 $2 이하로 유지

## 📈 실제 사용 시나리오

### 시나리오 A: 정상 운영 (현실적) ⭐

```
월 30일 기준:

변경 없는 날: 25일 (83%)
- LLM 호출: 0회 (고정 템플릿)
- 비용: $0

변경 있는 날: 5일 (17%)
- LLM 호출: 5회 (하루 1회 제한)
- 비용: 5 × $0.00039 = $0.00195

월간 총 비용: ~$0.20 (약 270원)
```

### 시나리오 B: 리콜 발생 (최악)

```
월 30일 기준:

변경 없는 날: 10일 (33%)
- LLM 호출: 0회
- 비용: $0

변경 있는 날: 20일 (67%)
- LLM 호출: 20회 (하루 1회 제한)
- 비용: 20 × $0.00039 = $0.0078

월간 총 비용: ~$0.40 (약 530원)
```

### 시나리오 C: 매일 변경 (극단적)

```
월 30일 모두 변경:
- LLM 호출: 30회 (하루 1회 제한)
- 비용: 30 × $0.00039 = $0.0117

월간 총 비용: ~$0.50 (약 670원)
```

## 💡 무료 대안 (참고용)

### LLM 무료 대안

#### 1. Groq (무료) ⭐
- 모델: Llama 3, Mixtral
- 속도: 매우 빠름
- 제한: 하루 14,400 요청
- 충분함: 하루 1회 사용

#### 2. Anthropic Claude (크레딧)
- 신규 가입: $5 무료 크레딧
- 모델: Claude 3 Haiku (저렴)

#### 3. 로컬 LLM (완전 무료)
- Ollama + Llama 3
- 서버 필요 (추가 비용)

**권장: OpenAI 그대로 사용**
- 안정성 최고
- 품질 최고
- 비용 충분히 저렴

## 🔍 비용 모니터링

### OpenAI Usage 확인
1. [OpenAI Platform](https://platform.openai.com/usage) 접속
2. Usage → 일별/월별 사용량 확인
3. $2 초과 시 알림 설정

### Vercel 사용량 확인
1. Vercel Dashboard → Usage
2. Functions 실행 시간 확인
3. KV 명령 수 확인

### GitHub Actions 사용량
1. GitHub → Settings → Billing
2. Actions 사용 시간 확인

## 🎁 추가 절감 팁

### 1. OpenAI 프로모션 활용
- 신규 가입 크레딧
- 학생 할인 (있는 경우)
- 프로모션 코드 확인

### 2. 소스 수 최적화
- Tier 1만 스캔 (이미 구현됨)
- 필요 시 소스 제거

### 3. 스캔 빈도 조정
- 필요 시 격일 스캔으로 변경
- GitHub Actions cron 수정

## 📊 경쟁 서비스 비교

| 서비스 | 월 비용 | 특징 |
|--------|---------|------|
| **이 프로젝트** | **$0.50 ~ $2** | 완전 커스터마이징 |
| IFTTT Pro | $5 | 제한적 |
| Zapier | $20+ | 비쌈 |
| Make.com | $9+ | 복잡함 |

**결론: 이 프로젝트가 가장 경제적!** 🎉

## 🎯 결론

### 총 비용 (연간) - 최적화 후 ⭐
```
최소: $0 (약 0원) - 변경 없는 경우
평균: $2.40 (약 3,200원) - 월 5일 변경
최대: $6 (약 8,000원) - 매일 변경

= 커피 1~2잔 값! ☕☕
```

### 최적화 전 vs 후
```
최적화 전: 월 $0.50 ~ $2 (연 $6 ~ $24)
최적화 후: 월 $0.10 ~ $0.50 (연 $1.20 ~ $6)

절감률: 75% ~ 80% 🎉
```

### 무료 서비스
- ✅ Telegram (100% 무료)
- ✅ Vercel (100% 무료)
- ✅ GitHub Actions (100% 무료)

### 유료 서비스
- 💳 OpenAI만 (월 $0.50 ~ $2)

**완벽한 가성비!** 🎉

---

**마지막 업데이트**: 2026-02-11  
**추천 플랜**: GitHub Actions + Vercel Hobby
